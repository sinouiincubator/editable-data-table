(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"./docs/SelectRow.css":function(e,n,t){var i=t("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./docs/SelectRow.css");"string"===typeof i&&(i=[[e.i,i,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0},s=t("./node_modules/style-loader/lib/addStyles.js")(i,a);i.locals&&(e.exports=i.locals),e.hot.accept("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./docs/SelectRow.css",function(){var n=t("./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./docs/SelectRow.css");if("string"===typeof n&&(n=[[e.i,n,""]]),!function(e,n){var t,i=0;for(t in e){if(!n||e[t]!==n[t])return!1;i++}for(t in n)i--;return 0===i}(i.locals,n.locals))throw new Error("Aborting CSS HMR due to changed css-modules locals.");s(n)}),e.hot.dispose(function(){s()})},"./docs/pagination-show-docs/pagination-show-demo.mdx":function(e,n,t){"use strict";t.r(n);var i=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),a=t("./node_modules/react/index.js"),s=t.n(a),r=t("./node_modules/@mdx-js/react/dist/index.es.js"),o=t("./node_modules/docz/dist/index.esm.js"),c=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js"),l=t.n(c),d=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),u=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),m=t("./node_modules/sinoui-components/Pagination/index.js"),b=t("./node_modules/sinoui-components/Button/index.js"),g=t("./node_modules/sinoui-components/TextInput/index.js"),p=t("./src/index.ts");t("./docs/SelectRow.css");function f(e,n,t){return Object(a.useMemo)(function(){return e.slice(n*t,(n+1)*t)},[e,t,n])}function S(e,n){return new Array(n-e).fill(null).map(function(n,t){return e+t})}function j(){var e=Object(p.d)("/api/pagination-show-demo",[]),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=Object(a.useState)(e),i=Object(u.a)(t,2),s=i[0],r=i[1],o=Object(a.useState)(n),c=Object(u.a)(o,2),l=c[0],d=c[1];return[s,l,function(e,n){r(e),d(n)}]}(),t=Object(u.a)(n,3),i=t[0],r=t[1],o=t[2],c=f(e.items,i,r),j=f(e.editingRows,i,r),x=function(e,n,t){return{add:Object(a.useCallback)(function(){e.add({},n*t)},[n,e,t]),save:Object(a.useCallback)(function(i,a){return e.save(i,n*t+a)},[n,e,t]),edit:Object(a.useCallback)(function(i){e.edit(n*t+i)},[n,e,t]),remove:Object(a.useCallback)(function(i,a){return e.remove(i,n*t+a)},[n,e,t])}}(e,i,r),P=x.add,v=x.save,w=x.edit,O=x.remove,h=Object(a.useState)(""),_=Object(u.a)(h,2),y=_[0],C=_[1],R=function(e,n,t){var i=n*t,s=Math.min(e.items.length,(n+1)*t),r=Object(a.useMemo)(function(){return i<s&&S(i,s).every(function(n){return-1!==e.selectedRows.indexOf(n)})},[e.selectedRows,s,i]),o=Object(a.useMemo)(function(){return i<s&&S(i,s).some(function(n){return-1!==e.selectedRows.indexOf(n)})},[e.selectedRows,s,i]),c=Object(a.useCallback)(function(){e.setRowsSelected(S(i,s),!r)},[e,s,r,i]);return{isAllSelected:r,isContainsSelected:o,toggleAllSelected:c,removeAllSelectedRows:(u=Object(d.a)(l.a.mark(function n(){var t;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.items.map(function(e,n){return[e,n]}).filter(function(n,t){return e.selectedRows.includes(t)}),n.next=3,e.remove(t);case 3:case"end":return n.stop()}},n)})),function(){return u.apply(this,arguments)})};var u}(e,i,r);return s.a.createElement("div",null,s.a.createElement(g.b,{value:y,onChange:function(e){return C(e.target.value)}}),s.a.createElement(b.b,{raised:!0,onClick:function(){e.query({title:y})}},"\u67e5\u8be2"),s.a.createElement(b.b,{raised:!0,onClick:P},"\u65b0\u589e"),s.a.createElement(b.b,{onClick:R.removeAllSelectedRows},"\u5220\u9664"),s.a.createElement(p.c,{data:c,editingRows:j,idPropertyName:e.idPropertyName,rowClassName:function(n){return e.selectedRows.includes(n+i*r)?"sinoui-data-table-body-row_selected":""}},s.a.createElement(p.a,{startIndex:i*r,selectedRows:e.selectedRows,isAllSelected:R.isAllSelected,isContainsSelected:R.isContainsSelected,toggleAllSelected:R.toggleAllSelected,toggleRowSelected:e.toggleRowSelected}),s.a.createElement(p.b,{name:"id",title:"id"}),s.a.createElement(p.b,{name:"title",title:"\u6807\u9898",editor:"input"}),s.a.createElement(p.b,{title:"\u64cd\u4f5c",name:"id",render:function(e,n,t,i,a){return s.a.createElement(s.a.Fragment,null,a.editing?s.a.createElement(b.b,{autoWidth:!0,onClick:function(){return v(n,t)}},"\u4fdd\u5b58"):s.a.createElement(b.b,{autoWidth:!0,onClick:function(){return w(t)}},"\u7f16\u8f91"),s.a.createElement(b.b,{autoWidth:!0,color:"danger",onClick:function(){return O(n,t)}},"\u5220\u9664"))}})),s.a.createElement(m.a,{pageSize:r,total:e.items.length,currentPage:i+1,onChange:function(e,n){return o(e-1,n)}}))}var x=j;j&&j===Object(j)&&Object.isExtensible(j)&&Object.defineProperty(j,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"Demo",filename:"docs/pagination-show-docs/Demo.tsx"}}),t.d(n,"default",function(){return w});var P={},v="wrapper";function w(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(r.b)(v,Object.assign({},P,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"\u5b8c\u6574\u793a\u4f8b"},"\u5b8c\u6574\u793a\u4f8b"),Object(r.b)("pre",null,Object(r.b)("code",Object.assign({parentName:"pre"},{className:"language-tsx"}),"import React, { useState, useMemo, useCallback } from 'react';\nimport Pagination from 'sinoui-components/Pagination';\nimport Button from 'sinoui-components/Button';\nimport TextInput from 'sinoui-components/TextInput';\nimport EditableDataTable, {\n  useEditingList,\n  TableColumn,\n  RowSelectColumn,\n} from '@sinouiincubator/editable-data-table';\n\ninterface Article {\n  id: string;\n  title: string;\n}\n\n/**\n * \u5206\u9875\u72b6\u6001hook\n */\nfunction usePagination(\n  defaultCurrentPage: number = 0,\n  defaultPageSize: number = 10,\n): [number, number, (pageNo: number, pageSize: number) => void] {\n  const [currentPage, setCurrentPage] = useState(defaultCurrentPage);\n  const [pageSize, setPageSize] = useState(defaultPageSize);\n\n  const update = (pageNo: number, newPageSize: number) => {\n    setCurrentPage(pageNo);\n    setPageSize(newPageSize);\n  };\n\n  return [currentPage, pageSize, update];\n}\n\n/**\n * \u83b7\u53d6\u5206\u9875\u5217\u8868\n *\n * @param items \u5217\u8868\n * @param currentPage \u5f53\u524d\u9875\n * @param pageSize \u9875\u5927\u5c0f\n */\nfunction usePaginationList<T>(\n  items: T[],\n  currentPage: number,\n  pageSize: number,\n) {\n  const data = useMemo(\n    () => items.slice(currentPage * pageSize, (currentPage + 1) * pageSize),\n    [items, pageSize, currentPage],\n  );\n\n  return data;\n}\n\n/**\n * \u83b7\u53d6\u5206\u9875\u7f16\u8f91\u5217\u8868\u7684\u52a8\u4f5c\n *\n * @param editingList \u7f16\u8f91\u5217\u8868\n * @param currentPage \u5f53\u524d\u9875\n * @param pageSize \u9875\u5927\u5c0f\n */\nfunction usePaginationEditingListActions<T>(\n  editingList: any,\n  currentPage: number,\n  pageSize: number,\n) {\n  const add = useCallback(() => {\n    editingList.add({}, currentPage * pageSize);\n  }, [currentPage, editingList, pageSize]);\n\n  const save = useCallback(\n    (item: T, index: number) => {\n      return editingList.save(item, currentPage * pageSize + index);\n    },\n    [currentPage, editingList, pageSize],\n  );\n\n  const edit = useCallback(\n    (index: number) => {\n      editingList.edit(currentPage * pageSize + index);\n    },\n    [currentPage, editingList, pageSize],\n  );\n\n  const remove = useCallback(\n    (item: T, index: number) => {\n      return editingList.remove(item, currentPage * pageSize + index);\n    },\n    [currentPage, editingList, pageSize],\n  );\n\n  return { add, save, edit, remove };\n}\n\n/**\n * \u751f\u6210\u5e8f\u5217\u6570\u7ec4\n *\n * @param start \u5f00\u59cb\n * @param end \u7ed3\u675f\n */\nfunction range(start: number, end: number) {\n  return new Array(end - start).fill(null).map((_, idx) => start + idx);\n}\n\n/**\n * \u5206\u9875\u7684\u9009\u4e2d\u884c\u72b6\u6001\n *\n * @param editingList \u53ef\u7f16\u8f91\u5217\u8868\n * @param currentPage \u5f53\u524d\u9875\n * @param pageSize \u9875\u5927\u5c0f\n */\nfunction usePaginationSelectedRows(\n  editingList: any,\n  currentPage: number,\n  pageSize: number,\n) {\n  const start = currentPage * pageSize;\n  const end = Math.min(editingList.items.length, (currentPage + 1) * pageSize);\n\n  /**\n   * \u5f53\u524d\u9875\u7684\u6570\u636e\u884c\u662f\u5426\u5168\u90e8\u9009\u4e2d\n   */\n  const isAllSelected = useMemo(() => {\n    return (\n      start < end &&\n      range(start, end).every(\n        (idx) => editingList.selectedRows.indexOf(idx) !== -1,\n      )\n    );\n  }, [currentPage, editingList.selectedRows, pageSize]);\n\n  /**\n   * \u662f\u5426\u5305\u542b\u5f53\u524d\u9875\u7684\u9009\u4e2d\u884c\n   */\n  const isContainsSelected = useMemo(() => {\n    return (\n      start < end &&\n      range(start, end).some(\n        (idx) => editingList.selectedRows.indexOf(idx) !== -1,\n      )\n    );\n  }, [currentPage, editingList.selectedRows, pageSize]);\n\n  /**\n   * \u5207\u6362\u5f53\u524d\u9875\u7684\u5168\u9009\n   */\n  const toggleAllSelected = useCallback(() => {\n    editingList.setRowsSelected(range(start, end), !isAllSelected);\n  }, [editingList, end, isAllSelected, start]);\n\n  /**\n   * \u5220\u9664\u6240\u6709\u9009\u4e2d\u7684\u6570\u636e\n   */\n  const removeAllSelectedRows = async () => {\n    const rows = editingList.items\n      .map((item, idx) => [item, idx])\n      .filter((_data, index) => editingList.selectedRows.includes(index));\n    await editingList.remove(rows);\n  };\n\n  return {\n    isAllSelected,\n    isContainsSelected,\n    toggleAllSelected,\n    removeAllSelectedRows,\n  };\n}\n\nfunction Demo() {\n  const editingList = useEditingList<Partial<Article>>(\n    '/api/pagination-show-demo',\n    [],\n  );\n  const [currentPage, pageSize, update] = usePagination();\n  const data = usePaginationList(editingList.items, currentPage, pageSize);\n  const editingRows = usePaginationList(\n    editingList.editingRows,\n    currentPage,\n    pageSize,\n  );\n\n  const { add, save, edit, remove } = usePaginationEditingListActions(\n    editingList,\n    currentPage,\n    pageSize,\n  );\n\n  const [searchText, setSearchText] = useState('');\n  const handleQuery = () => {\n    editingList.query({ title: searchText });\n  };\n\n  const handleRowClassName = (index: number) => {\n    if (editingList.selectedRows.includes(index + currentPage * pageSize)) {\n      return 'sinoui-data-table-body-row_selected';\n    }\n\n    return '';\n  };\n\n  const paginationSelectedRows = usePaginationSelectedRows(\n    editingList,\n    currentPage,\n    pageSize,\n  );\n\n  return (\n    <div>\n      <TextInput\n        value={searchText}\n        onChange={(event) => setSearchText(event.target.value)}\n      />\n      <Button raised onClick={handleQuery}>\n        \u67e5\u8be2\n      </Button>\n      <Button raised onClick={add}>\n        \u65b0\u589e\n      </Button>\n      <Button onClick={paginationSelectedRows.removeAllSelectedRows}>\n        \u5220\u9664\n      </Button>\n      <EditableDataTable\n        data={data}\n        editingRows={editingRows}\n        idPropertyName={editingList.idPropertyName}\n        rowClassName={handleRowClassName}\n      >\n        <RowSelectColumn\n          startIndex={currentPage * pageSize}\n          selectedRows={editingList.selectedRows}\n          isAllSelected={paginationSelectedRows.isAllSelected}\n          isContainsSelected={paginationSelectedRows.isContainsSelected}\n          toggleAllSelected={paginationSelectedRows.toggleAllSelected}\n          toggleRowSelected={editingList.toggleRowSelected}\n        />\n        <TableColumn name=\"id\" title=\"id\" />\n        <TableColumn name=\"title\" title=\"\u6807\u9898\" editor=\"input\" />\n        <TableColumn\n          title=\"\u64cd\u4f5c\"\n          name=\"id\"\n          render={(_value, item, index, _id, context) => (\n            <>\n              {context.editing ? (\n                <Button autoWidth onClick={() => save(item, index)}>\n                  \u4fdd\u5b58\n                </Button>\n              ) : (\n                <Button autoWidth onClick={() => edit(index)}>\n                  \u7f16\u8f91\n                </Button>\n              )}\n              <Button\n                autoWidth\n                color=\"danger\"\n                onClick={() => remove(item, index)}\n              >\n                \u5220\u9664\n              </Button>\n            </>\n          )}\n        />\n      </EditableDataTable>\n      <Pagination\n        pageSize={pageSize}\n        total={editingList.items.length}\n        currentPage={currentPage + 1}\n        onChange={(pageNo, size) => update(pageNo - 1, size)}\n      />\n    </div>\n  );\n}\n\nexport default Demo;\n")),Object(r.b)("p",null,"\u6548\u679c\uff1a"),Object(r.b)(o.c,{__position:0,__code:"<Demo />",__scope:{props:this?this.props:t,Playground:o.c,Demo:x},mdxType:"Playground"},Object(r.b)(x,{mdxType:"Demo"})))}w&&w===Object(w)&&Object.isExtensible(w)&&Object.defineProperty(w,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"MDXContent",filename:"docs/pagination-show-docs/pagination-show-demo.mdx"}}),w.isMDXComponent=!0},"./node_modules/css-loader/dist/cjs.js?!./node_modules/postcss-loader/src/index.js?!./docs/SelectRow.css":function(e,n,t){(e.exports=t("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,".sinoui-editable-data-table .sinoui-data-table-body-row_selected {\n  background-color: rgba(0, 0, 0, 0.12);\n}\n",""])},"./src/RowSelectColumn.tsx":function(e,n,t){"use strict";var i=t("./node_modules/react/index.js"),a=t.n(i),s=t("./node_modules/sinoui-components/Checkbox/index.js"),r=t("./src/TableColumn.tsx");function o(e){var n=e.isAllSelected,t=e.isContainsSelected,i=e.toggleAllSelected,o=e.selectedRows,c=e.toggleRowSelected,l=e.startIndex,d=void 0===l?0:l;return a.a.createElement(r.b,{width:50,title:a.a.createElement(s.b,{checked:n,indeterminate:!n&&t,onChange:i}),render:function(e,n,t){return a.a.createElement(s.b,{checked:-1!==o.indexOf(t+d),onChange:function(){return c(t+d)}})}})}n.a=o,o&&o===Object(o)&&Object.isExtensible(o)&&Object.defineProperty(o,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"RowSelectColumn",filename:"src/RowSelectColumn.tsx"}})},"./src/index.ts":function(e,n,t){"use strict";var i=t("./src/EditableDataTable.tsx"),a=t("./src/TableColumn.tsx");t.d(n,"b",function(){return a.b});var s=t("./src/shared/EditorProps.ts"),r=t.n(s),o=t("./src/useEditingList.ts");t.d(n,"d",function(){return o.a});var c=t("./src/useSimpleEditingList.ts");t.d(n,"e",function(){return c.a});var l=t("./src/RowSelectColumn.tsx");t.d(n,"a",function(){return l.a}),n.c=i.b,"undefined"!==typeof i.b&&i.b&&i.b===Object(i.b)&&Object.isExtensible(i.b)&&Object.defineProperty(i.b,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"EditableDataTable",filename:"src/index.ts"}}),"undefined"!==typeof l.a&&l.a&&l.a===Object(l.a)&&Object.isExtensible(l.a)&&Object.defineProperty(l.a,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"RowSelectColumn",filename:"src/index.ts"}}),"undefined"!==typeof c.a&&c.a&&c.a===Object(c.a)&&Object.isExtensible(c.a)&&Object.defineProperty(c.a,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useSimpleEditingList",filename:"src/index.ts"}}),"undefined"!==typeof o.a&&o.a&&o.a===Object(o.a)&&Object.isExtensible(o.a)&&Object.defineProperty(o.a,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useEditingList",filename:"src/index.ts"}}),"undefined"!==typeof r.a&&r.a&&r.a===Object(r.a)&&Object.isExtensible(r.a)&&Object.defineProperty(r.a,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"EditorProps",filename:"src/index.ts"}}),"undefined"!==typeof a.Props&&a.Props&&a.Props===Object(a.Props)&&Object.isExtensible(a.Props)&&Object.defineProperty(a.Props,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"TableColumnProps",filename:"src/index.ts"}}),"undefined"!==typeof a.b&&a.b&&a.b===Object(a.b)&&Object.isExtensible(a.b)&&Object.defineProperty(a.b,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"TableColumn",filename:"src/index.ts"}}),"undefined"!==typeof i.Props&&i.Props&&i.Props===Object(i.Props)&&Object.isExtensible(i.Props)&&Object.defineProperty(i.Props,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"EditableDataTableProps",filename:"src/index.ts"}})},"./src/shared/EditorProps.ts":function(e,n){},"./src/useEditingList.ts":function(e,n,t){"use strict";t.d(n,"a",function(){return b});var i=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread.js"),a=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js"),s=t.n(a),r=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),o=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),c=t("./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),l=t("./node_modules/@sinoui/use-rest-list-api/dist/index.js"),d=t.n(l),u=t("./node_modules/react/index.js"),m=t("./src/useSimpleEditingList.ts");function b(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,a=t||{},l=a.keyName,b=void 0===l?"id":l,g=a.alwaysEditing,p=void 0!==g&&g,f=d()(e,n,t),S=f.items,j=f.remove,x=f.update,P=f.save,v=f.isLoading,w=f.isError,O=f.query,h=f.fetch,_=f.sortWith,y=f.reload,C=f.reset,R=f.searchParams,E=f.sorts,L=Object(m.a)(S,t),k=L.setItems,z=L.remove,A=L.updateItem,T=L.setReadonly,N=Object(c.a)(L,["setItems","remove","updateItem","setReadonly"]);Object(u.useEffect)(function(){k(S)},[k,S]);var B=Object(u.useCallback)(function(e){return e[b]},[b]),D=Object(u.useCallback)(function(){var e=Object(o.a)(s.a.mark(function e(n,t){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(n)){e.next=7;break}if(!((i=n.map(function(e){var n=Object(r.a)(e,1)[0];return B(n)}).filter(Boolean)).length>0)){e.next=5;break}return e.next=5,j(i,!1);case 5:e.next=10;break;case 7:if(!B(n)){e.next=10;break}return e.next=10,j(B(n),!1);case 10:z(Array.isArray(n)?n.map(function(e){return Object(r.a)(e,2)[1]}):t);case 11:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),[j,z,B]),M=Object(u.useCallback)(function(){var e=Object(o.a)(s.a.mark(function e(n,t){var i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!B(n)){e.next=6;break}return e.next=3,x(n,!1);case 3:i=e.sent,e.next=9;break;case 6:return e.next=8,P(n,!1);case 8:i=e.sent;case 9:A(t,i),p||T(t);case 11:case"end":return e.stop()}},e)}));return function(n,t){return e.apply(this,arguments)}}(),[B,A,p,x,P,T]);return Object(i.a)({},N,{query:O,fetch:h,sortWith:_,reload:y,reset:C,searchParams:R,sorts:E,isLoading:v,isError:w,remove:D,save:M,idPropertyName:b,setReadonly:T})}b&&b===Object(b)&&Object.isExtensible(b)&&Object.defineProperty(b,"__filemeta",{enumerable:!0,configurable:!0,value:{name:"useEditingList",filename:"src/useEditingList.ts"}})}}]);
//# sourceMappingURL=docs-pagination-show-docs-pagination-show-demo.3c8e61a88419f476c67d.js.map